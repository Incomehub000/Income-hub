<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü - INCOME HUB</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .income-container {
            max-width: 1000px;
            margin: 80px auto 20px;
            padding: 20px;
        }
        
        .income-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            border-top: 4px solid #667eea;
        }
        
        .stat-card.today { border-top-color: #4CAF50; }
        .stat-card.week { border-top-color: #2196F3; }
        .stat-card.month { border-top-color: #f39c12; }
        .stat-card.total { border-top-color: #9b59b6; }
        
        .income-amount {
            font-size: 2rem;
            font-weight: bold;
            margin: 15px 0;
        }
        
        .today-amount { color: #4CAF50; }
        .week-amount { color: #2196F3; }
        .month-amount { color: #f39c12; }
        .total-amount { color: #9b59b6; }
        
        .income-list {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 30px;
        }
        
        .list-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 15px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .income-item {
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 15px;
            align-items: center;
            transition: background 0.3s;
        }
        
        .income-item:hover {
            background: #f8f9fa;
        }
        
        .income-item:last-child {
            border-bottom: none;
        }
        
        .income-source {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .source-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .income-details h4 {
            margin: 0;
            color: #2c3e50;
        }
        
        .income-details p {
            margin: 5px 0 0 0;
            color: #666;
            font-size: 0.9rem;
        }
        
        .income-amount-positive {
            font-weight: bold;
            color: #4CAF50;
            font-size: 1.1rem;
        }
        
        .income-date {
            color: #666;
            font-size: 0.9rem;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .filter-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background: #f8f9fa;
            border: 2px solid #ddd;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <h2><a href="../index.html" style="color: white; text-decoration: none;">INCOME HUB</a></h2>
            </div>
            <div class="nav-buttons">
                <button class="btn login-btn" onclick="window.location.href='../dashboard.html'">‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</button>
                <button class="btn register-btn" onclick="logout()">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
            </div>
        </div>
    </nav>

    <div class="income-container">
        <h1 style="text-align: center; margin-bottom: 10px; color: #333;">üìà ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h1>
        <p style="text-align: center; margin-bottom: 30px; color: #666;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</p>
        
        <!-- ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ -->
        <div class="income-stats">
            <div class="stat-card today">
                <h3>üìÖ ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ</h3>
                <div class="income-amount today-amount" id="todayIncome">0</div>
                <p>‡¶ï‡¶Ø‡¶º‡ßá‡¶®</p>
            </div>
            
            <div class="stat-card week">
                <h3>üìä ‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ</h3>
                <div class="income-amount week-amount" id="weekIncome">0</div>
                <p>‡¶ï‡¶Ø‡¶º‡ßá‡¶®</p>
            </div>
            
            <div class="stat-card month">
                <h3>üóìÔ∏è ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ</h3>
                <div class="income-amount month-amount" id="monthIncome">0</div>
                <p>‡¶ï‡¶Ø‡¶º‡ßá‡¶®</p>
            </div>
            
            <div class="stat-card total">
                <h3>üí∞ ‡¶Æ‡ßã‡¶ü ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ</h3>
                <div class="income-amount total-amount" id="totalIncome">0</div>
                <p>‡¶ï‡¶Ø‡¶º‡ßá‡¶®</p>
            </div>
        </div>
        
        <!-- ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
        <div class="filter-section">
            <h3 style="margin-bottom: 15px; color: #333;">üîç ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterIncome('all')">‡¶∏‡¶¨</button>
                <button class="filter-btn" onclick="filterIncome('task')">‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</button>
                <button class="filter-btn" onclick="filterIncome('referral')">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤</button>
                <button class="filter-btn" onclick="filterIncome('premium')">‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ</button>
                <button class="filter-btn" onclick="filterIncome('bonus')">‡¶¨‡ßã‡¶®‡¶æ‡¶∏</button>
            </div>
        </div>
        
        <!-- ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü -->
        <div class="income-list">
            <div class="list-header">
                <div>‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶∏‡ßã‡¶∞‡ßç‡¶∏</div>
                <div>‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</div>
                <div>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</div>
                <div>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</div>
            </div>
            
            <div id="incomeList">
                <!-- ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá -->
            </div>
        </div>
    </div>

    <script>
        let currentFilter = 'all';
        
        // ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            
            if (!currentUser) {
                alert('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!');
                window.location.href = '../login.html';
                return;
            }
            
            updateIncomeData(currentUser);
            loadIncomeHistory(currentUser);
        });
        
        // ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        function updateIncomeData(user) {
            const incomeHistory = user.incomeHistory || [];
            
            // ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ
            const today = new Date().toDateString();
            const todayIncome = incomeHistory.filter(income => 
                new Date(income.date).toDateString() === today
            ).reduce((sum, income) => sum + income.amount, 0);
            
            // ‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ
            const oneWeekAgo = new Date();
            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
            const weekIncome = incomeHistory.filter(income => 
                new Date(income.date) >= oneWeekAgo
            ).reduce((sum, income) => sum + income.amount, 0);
            
            // ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ
            const oneMonthAgo = new Date();
            oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
            const monthIncome = incomeHistory.filter(income => 
                new Date(income.date) >= oneMonthAgo
            ).reduce((sum, income) => sum + income.amount, 0);
            
            // ‡¶Æ‡ßã‡¶ü ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ
            const totalIncome = incomeHistory.reduce((sum, income) => sum + income.amount, 0);
            
            document.getElementById('todayIncome').textContent = formatNumber(todayIncome);
            document.getElementById('weekIncome').textContent = formatNumber(weekIncome);
            document.getElementById('monthIncome').textContent = formatNumber(monthIncome);
            document.getElementById('totalIncome').textContent = formatNumber(totalIncome);
        }
        
        // ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶≤‡ßã‡¶°
        function loadIncomeHistory(user, filter = 'all') {
            const incomeHistory = user.incomeHistory || [];
            const container = document.getElementById('incomeList');
            
            if (incomeHistory.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>üòî ‡¶è‡¶ñ‡¶®‡¶ì ‡¶ï‡ßã‡¶®‡ßã ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶®‡ßá‡¶á</h3>
                        <p>‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá ‡¶¨‡¶æ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®!</p>
                    </div>
                `;
                return;
            }
            
            // ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ó
            let filteredIncome = incomeHistory;
            if (filter !== 'all') {
                filteredIncome = incomeHistory.filter(income => income.type === filter);
            }
            
            // ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã (‡¶®‡¶§‡ßÅ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã)
            filteredIncome.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = '';
            filteredIncome.forEach(income => {
                const sourceIcons = {
                    'task': 'üìã',
                    'referral': 'üë•',
                    'premium': '‚≠ê',
                    'bonus': 'üéÅ',
                    'registration': 'üéØ'
                };
                
                const sourceNames = {
                    'task': '‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶∂‡¶®',
                    'referral': '‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏',
                    'premium': '‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ',
                    'bonus': '‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏',
                    'registration': '‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶¨‡ßã‡¶®‡¶æ‡¶∏'
                };
                
                html += `
                    <div class="income-item">
                        <div class="income-source">
                            <div class="source-icon">
                                ${sourceIcons[income.type] || 'üí∞'}
                            </div>
                            <div class="income-details">
                                <h4>${sourceNames[income.type] || income.type}</h4>
                            </div>
                        </div>
                        
                        <div>
                            <p>${income.description || '‡¶á‡¶®‡¶ï‡¶æ‡¶Æ'}</p>
                        </div>
                        
                        <div class="income-amount-positive">
                            +${formatNumber(income.amount)} ‡¶ï‡¶Ø‡¶º‡ßá‡¶®
                        </div>
                        
                        <div class="income-date">
                            ${new Date(income.date).toLocaleDateString('bn-BD', {
                                year: 'numeric',
                                month: 'short',
                                day: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            })}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function filterIncome(filter) {
            currentFilter = filter;
            
            // ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ‡¶°‡ßá‡¶ü‡¶æ ‡¶∞‡¶ø‡¶≤‡ßã‡¶°
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            loadIncomeHistory(currentUser, filter);
        }
        
        // ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        function logout() {
            localStorage.removeItem('currentUser');
            alert('‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶∏‡¶´‡¶≤!');
            window.location.href = '../index.html';
        }
    </script>
</body>
  </html>
